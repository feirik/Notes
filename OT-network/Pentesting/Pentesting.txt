VMs
---
Kali (regenerate SSH, disable web server, https://github.com/moki-ics/moki)

ControlThings (regenerate SSH, disable web server)

Clean installs and snapshots

Remember relevant cables necessary

https://www.controlthings.io/resources


General approach
----------------
Know what the commands actually do to the network and hosts


Considerations
--------------
Are systems too sensitive to be scanned?

Possible to extract SW version numbers in other ways?

PLCs and relevant hosts available in a test environment?

P3.0 and P3.5 are easier to scan in general


Access need to conduct testing
------------------------------
AD-user if applicable

Connect to P4 switch - Scan for OT assets from the outside

Connect to P3.5 switch - Scan DMZ hosts

Connect to P3 switch - Focus on P3 hosts and common targets

Connect to P2 switch - Scan, such as running a Nessus ICS scan


Output
------
Overall - Validate the risk level - Make suggestions for high impact low effort fixes


Signs of limited OT knowledge in pentesting
-------------------------------------------
Poor answers in scoping meetings for:

What do you do with assets that should not be scanned? (ICS applicable ways of running nmap, Nessus etc.)

Low understanding of Purdue

What questions are pentesters asking? How knowledgeable are the testers about the systems to be tested?


Vuln databases
--------------
https://www.cisa.gov/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95

https://nvd.nist.gov/

