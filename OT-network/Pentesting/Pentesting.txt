VMs
---
Kali (regenerate SSH, disable web server, https://github.com/moki-ics/moki)

ControlThings (regenerate SSH, disable web server)

Clean installs and snapshots

Remember relevant cables necessary

https://www.controlthings.io/resources


Assessment overview
-------------------
OT risk   Cost    
             $   Vendor review - review of how a vendor approaches security
            $$   Security research - Analysis of technology to understand functionality and security controls (external or vendor)
      !    $$$   Security assessment - Review of an application, single system or system of systems to define requirements and identify risk
            $$   Threat modelling - Technical review of specific or all parts of the OT environment to identify risks and prioritize efforts
     !!    $$$   Security program maturity - Review of security posture of a control environment to identify risks and prioritize effort
    !!!    $$$   Pen test - Active testing to access systems and gain further access, pivot and persist in the environment (focus on defenses)
    !!!   $$$$   Red team - Active testing to stealthily access the control environment to simulate an adversary evading controls (focus on defenders)


General approach
----------------
White glove treatment - Make management, process engineers, operators and IT personnel comfortable

Plan and scope assessment with sufficient lead time

Identify critical process times (avoid them)

Identify maintenance, upgrade and testing windows (utilize them)

Identify specific assessment goals for OT, IT and security teams (test to the goals)

Define and work security into FAT/SAT processes where possible


Technical approach
------------------
Know what the commands actually do to the network and hosts

Architecture reviews, site walk through, interviews, threat modelling

Passively monitor network communications

Process interaction - Configuration Hardening Assessment PowerShell Script (CHAPS)
                    - Windows Exploit Suggester (wesng)

AD testing

Windows Shares review

Interact with field devices where appropirate


Considerations
--------------
Are systems too sensitive to be scanned?

Possible to extract SW version numbers in other ways?

PLCs and relevant hosts available in a test environment?

P3.0 and P3.5 are easier to scan in general


Access need to conduct testing
------------------------------
AD-user if applicable

Connect to P4 switch - Scan for OT assets from the outside

Connect to P3.5 switch - Scan DMZ hosts

Connect to P3 switch - Focus on P3 hosts and common targets

Connect to P2 switch - Scan, such as running a Nessus ICS scan


Output
------
Overall - Validate the risk level - Make suggestions for high impact low effort fixes


Signs of limited OT knowledge in pentesting
-------------------------------------------
Poor answers in scoping meetings for:

What do you do with assets that should not be scanned? (ICS applicable ways of running nmap, Nessus etc.)

Low understanding of Purdue

What questions are pentesters asking? How knowledgeable are the testers about the systems to be tested?


Vuln databases
--------------
https://www.cisa.gov/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A95

https://nvd.nist.gov/

