Distributed Network Protocol 3 (DNP3) is a set of protocols often used in electric and water utilities. Uses port 19999 TCP (TLS) and port 20000 TCP/UDP.

DNP3 is has more overhead and is more complex than Modbus, but offsets this by polling and slave initiated communication (alarms).

A master is refered to as "master station" and slave is referred to as "outstation".

Typically DNP3 can replace Modbus, but is also used for converting polled protocol Modbus to event based DNP3.

SCADA <---> DNP3 Concentrator at remote-site <---> Modbus <---> Field devices

This setup allows the Concentrator to poll Modbus at set intervals, and only send large data packets to SCADA in case of alarm or major change (event polling).

DNP3 also has built in data buffering, allowing communcation to be stored until data link is ready again.


DNP3 message structure
**********************
Object group
------------
Type of input or output (Binary, analog, counter, time, class)

Variation
---------
Sub-class of object group (read with/without flags, polling etc.)

Function code
-------------
Instruction on how to interact with field device (read, write, select, operate etc.)

Point mapping
-------------
Data is stored in tags according to master/slave point mapping


Often used groups
-----------------
Group 1 - Variation 2 (Binary input with flags)

Group 10 - Variation 2 (Binary output status with flags)

Group 60 - Variation 1 (Read all static/current data for the device)

Group 60 - Variation 1/2/3 (Event poll if something changes outside limits, by priority 1/2/3 p)


Security
********
DNP3 is inherently not designed for security. Primary recommendation is to use DNP3 Secure, which adds authentication of messages at the cost of complexity.

Firewall traffic
----------------
Non-DNP3 traffic masked as DNP3 on port 19999/20000

Use of configuration function code 23 (Disable unsolicted response - slave alarm reporting)

Use of control functions 4, 5, 6 (Operate, direct operate and direct operate without ack - Regular process is select before operate)

Use of application control function 18 (Stop application)

Multiple unsolicted responses over time (DoS from response storm)

Any unauthorized attempts to perform function requiring authorization

Authentication failures

DNP3 communcation to/from devices not explicitly defined as DNP3 devices



